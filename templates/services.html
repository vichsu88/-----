{% extends "base.html" %}

{% block title %}æ‰¿å¤©ä¸­æ‰¿åºœ - æ¿Ÿä¸–æœå‹™{% endblock %}

{% block content %}
<style>
    /* === å…¨åŸŸè¨­å®š === */
    :root {
        --primary-gold: #C48945;
        --bg-offwhite: #F9F7F2;
        --text-dark: #333;
    }
    body { background-color: var(--bg-offwhite); }

    /* === 1. Hero é ‚éƒ¨å½±éŸ³å€ (å…¨è¢å¹•æ„Ÿ) === */
    .service-hero {
        position: relative;
        width: 100%;
        height: 70vh; /* ä½”æ“šè¢å¹• 70% é«˜åº¦ */
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #000;
    }
    .video-background {
        position: absolute;
        top: 50%; left: 50%;
        width: 100vw; height: 100vh; /* æ”¾å¤§ä»¥è¦†è“‹ */
        transform: translate(-50%, -50%);
        pointer-events: none; /* ç¦æ­¢é»æ“Šå½±ç‰‡ */
        opacity: 0.6; /* ç¨å¾®è®Šæš—è®“æ–‡å­—æ¸…æ¥š */
        z-index: 1;
    }
    .video-background iframe {
        width: 100%; height: 100%;
        object-fit: cover;
    }
    .hero-content {
        position: relative;
        z-index: 2;
        text-align: center;
        color: #fff;
        padding: 20px;
    }
    .hero-title {
        font-family: 'KouzanBrushFontOTF', serif;
        font-size: 3.5rem;
        margin-bottom: 10px;
        text-shadow: 0 0 20px rgba(196, 137, 69, 0.8);
        letter-spacing: 5px;
    }
    .hero-subtitle {
        font-size: 1.4rem;
        font-weight: 300;
        margin-bottom: 30px;
        line-height: 1.6;
        text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
    }
    /* å¿«é€Ÿå°èˆªæŒ‰éˆ•åˆ— */
    .hero-nav {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
    }
    .nav-anchor {
        padding: 12px 30px;
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(5px);
        border: 1px solid rgba(255, 255, 255, 0.4);
        color: #fff;
        text-decoration: none;
        border-radius: 50px;
        transition: 0.3s;
        font-weight: bold;
        letter-spacing: 1px;
    }
    .nav-anchor:hover {
        background: var(--primary-gold);
        border-color: var(--primary-gold);
        transform: translateY(-3px);
    }

    /* === 2. ç¾å ´å•äº‹å€ (å·¦åœ–å³æ–‡) === */
    .gongtan-section {
        max-width: 1200px;
        margin: 60px auto;
        padding: 0 20px;
        display: flex;
        align-items: center;
        gap: 50px;
    }
    .gongtan-img-box {
        flex: 1;
        position: relative;
    }
    .gongtan-img {
        width: 100%;
        border-radius: 15px;
        box-shadow: 10px 10px 0 var(--primary-gold); /* è£é£¾é™°å½± */
        object-fit: cover;
    }
    .gongtan-content {
        flex: 1;
    }
    .section-header {
        border-left: 5px solid var(--primary-gold);
        padding-left: 15px;
        margin-bottom: 30px;
    }
    .section-header h2 {
        font-size: 2rem;
        color: #8B4513;
        margin: 0;
    }
    .section-header span {
        color: #666;
        font-size: 1rem;
    }

    /* æµç¨‹æ­¥é©Ÿç¾åŒ– */
    .process-steps {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }
    .step-item {
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        border-left: 4px solid #ddd;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        transition: 0.3s;
    }
    .step-item:hover {
        border-left-color: var(--primary-gold);
        transform: translateX(5px);
    }
    .step-title {
        font-weight: bold;
        color: #8B4513;
        font-size: 1.1rem;
        margin-bottom: 5px;
        display: flex;
        justify-content: space-between;
    }
    .step-desc {
        font-size: 0.95rem;
        color: #555;
        line-height: 1.5;
    }
    .line-btn {
        display: inline-block;
        background: #06c755;
        color: white;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        text-decoration: none;
        margin-left: 10px;
    }

    /* === 3. ä¿¡å¾’è¦‹è­‰è·‘é¦¬ç‡ˆ === */
    .feedback-section {
        background: #fff;
        padding: 50px 0;
        margin: 60px 0;
        border-top: 1px solid #eee;
        border-bottom: 1px solid #eee;
        overflow: hidden; /* éš±è—è¶…å‡ºéƒ¨åˆ† */
    }
    .marquee-wrapper {
        display: flex;
        width: 100%;
        position: relative;
    }
    .marquee-track {
        display: flex;
        gap: 30px;
        animation: scrollLeft 40s linear infinite;
        width: max-content; /* è®“å¯¬åº¦ä¾å…§å®¹å»¶ä¼¸ */
    }
    .feedback-card {
        width: 300px;
        background: #F9F7F2;
        padding: 20px;
        border-radius: 10px;
        border: 1px solid #eee;
        flex-shrink: 0; /* é˜²æ­¢è¢«å£“ç¸® */
    }
    .fb-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 10px;
    }
    .fb-avatar {
        width: 40px; height: 40px;
        background: #ddd;
        border-radius: 50%;
        display: flex; justify-content: center; align-items: center;
        font-weight: bold; color: #fff; background: var(--primary-gold);
    }
    .fb-content {
        font-size: 0.9rem;
        color: #555;
        line-height: 1.5;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    .fb-link {
        text-align: center;
        margin-top: 20px;
    }
    @keyframes scrollLeft {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); } /* å‡è¨­è¤‡è£½äº†ä¸€ä»½ï¼Œç§»å‹•ä¸€åŠè·é›¢ */
    }

    /* === 4. é è·æœå‹™ (å¡ç‰‡å€) === */
    .remote-section {
        max-width: 1000px;
        margin: 0 auto 80px auto;
        text-align: center;
        padding: 0 20px;
    }
    .remote-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin-top: 40px;
    }
    .remote-card {
        background: #fff;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        transition: 0.3s;
        border: 1px solid #eee;
        display: flex;
        flex-direction: column;
    }
    .remote-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 30px rgba(196, 137, 69, 0.2);
        border-color: var(--primary-gold);
    }
    .remote-img {
        width: 100%;
        height: 250px;
        object-fit: cover;
    }
    .remote-text {
        padding: 25px;
        flex: 1;
        display: flex;
        flex-direction: column;
    }
    .remote-text h3 { margin: 0 0 10px 0; color: #8B4513; }
    .remote-text p { color: #666; font-size: 0.95rem; line-height: 1.6; flex: 1; }
    .btn-action {
        display: block;
        margin-top: 20px;
        padding: 12px;
        background: var(--primary-gold);
        color: #fff;
        text-decoration: none;
        border-radius: 5px;
        font-weight: bold;
        transition: 0.3s;
    }
    .btn-action:hover { background: #a06d35; }

    /* RWD æ‰‹æ©Ÿèª¿æ•´ */
    @media (max-width: 768px) {
        .hero-title { font-size: 2.2rem; }
        .hero-subtitle { font-size: 1.1rem; }
        .service-hero { height: 60vh; }
        
        .gongtan-section { flex-direction: column; gap: 30px; }
        .gongtan-img { box-shadow: 5px 5px 0 var(--primary-gold); }
        
        .remote-grid { grid-template-columns: 1fr; }
        .remote-img { height: 200px; }
        
        /* è·‘é¦¬ç‡ˆåœ¨æ‰‹æ©Ÿä¸Šæ”¹ç‚ºå–®å¼µæ»‘å‹•å¯èƒ½æ›´å¥½ï¼Œä½†é€™è£¡å…ˆç¶­æŒè·‘é¦¬ç‡ˆ */
    }
</style>

<header class="service-hero">
    <div class="video-background">
        <iframe 
            src="https://www.youtube.com/embed/odpTDkvJBpw?autoplay=1&mute=1&loop=1&playlist=odpTDkvJBpw&controls=0&showinfo=0&rel=0&playsinline=1" 
            title="Hero Video" 
            frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            allowfullscreen>
        </iframe>
    </div>
    <div class="hero-content">
        <h1 class="hero-title">ä¿¡ä»°æœ‰ä¾ â€§ å¿ƒå®‰å³å®¶</h1>
        <div class="hero-subtitle">
            <p>ä¸­å£‡å…ƒå¸¥èˆ‡å…ƒå¸¥å¨˜ï¼Œä»¥æ…ˆæ‚²ä¹‹å¿ƒï¼Œ<br>åšæ‚¨å …å¯¦çš„ä¾é ï¼Œè®“æ‡¸è‘—çš„å¿ƒå¾æ­¤è¸å¯¦ã€‚</p>
        </div>
        <div class="hero-nav">
            <a href="#gongtan" class="nav-anchor">ğŸ™Œ ç¾å ´å•äº‹</a>
            <a href="#remote" class="nav-anchor">ğŸ“¦ å¯„å›è¡£ç‰©</a>
            <a href="#remote" class="nav-anchor">ğŸ•¯ï¸ ç·šä¸Šæé¦™</a>
        </div>
    </div>
</header>

<section id="gongtan" class="gongtan-section">
    <div class="gongtan-img-box">
        <img src="{{ url_for('static', filename='images/pages/gongtan/signuppic.jpg') }}" alt="å…ƒå¸¥è¾¦äº‹" class="gongtan-img">
    </div>
    <div class="gongtan-content">
        <div class="section-header">
            <h2>å…¬å£‡å•äº‹ / æ”¶é©š</h2>
            <span>æ¯é€±å›ºå®šé–‹å£‡ â€§ ç¾å ´æ›è™Ÿ</span>
        </div>
        
        <div class="process-steps">
            <div class="step-item">
                <div class="step-title">
                    1. åŠ å…¥ç¤¾ç¾¤ â€§ é—œæ³¨å‹•æ…‹
                    <a href="{{ links['å…ƒå¸¥å¨˜å®˜æ–¹LINE'] or '#' }}" target="_blank" class="line-btn">åŠ å…¥ LINE</a>
                </div>
                <div class="step-desc">
                    è«‹å…ˆåŠ å…¥å®˜æ–¹ LINE ç¾¤çµ„ã€‚æˆ‘å€‘å°‡æ–¼ç¾¤çµ„å…§å…¬å‘Šä¸‹å€‹æœˆçš„ã€Œå…¬å£‡æ—¥æœŸã€ã€ã€Œå ±åæ—¥æœŸã€åŠã€Œé–‹æ”¾åé¡ã€ã€‚<br>
                    <small style="color:red;">*æ¯äººé™åŠ  1 ç¾¤ï¼Œé•è€…å°‡è¸¢å‡ºç¾¤çµ„ã€‚</small>
                </div>
            </div>
            
            <div class="step-item">
                <div class="step-title">2. ç·šä¸Šå ±å â€§ æº–æ™‚æ¶å¿«</div>
                <div class="step-desc">
                    å ±åç•¶æ—¥ï¼Œå°‡ç”±å°ç·¨æ–¼ç¾¤çµ„ç™¼å¸ƒã€Œå ±åé–‹å§‹ã€è¨Šæ¯ã€‚è«‹ç«‹å³åœ¨è¨Šæ¯ä¸‹æ–¹ç•™è¨€ã€Œ+1ã€ï¼Œåé¡æœ‰é™ï¼Œé¡æ»¿å³æ­¢ã€‚
                </div>
            </div>
            
            <div class="step-item">
                <div class="step-title">3. åå–®å…¬å‘Š & ç¾å ´å ±åˆ°</div>
                <div class="step-desc">
                    å ±åæˆåŠŸè€…ï¼Œç¾©å·¥å°‡æ•´ç†ä¸¦å…¬å‘Šæ­£å¼åå–®ã€‚è«‹å‹™å¿…æ–¼å…¬å‘Šæ™‚é–“çš„ã€Œå…©å°æ™‚å…§ã€æŠµé”ç¾å ´å®Œæˆå ±åˆ°æ‰‹çºŒã€‚
                </div>
            </div>
        </div>
    </div>
</section>

<section class="feedback-section">
    <div style="text-align:center; margin-bottom:30px;">
        <h2 style="color:#8B4513; margin:0;">ğŸ’¬ ä¿¡å¾’çœŸå¯¦å›é¥‹</h2>
        <p style="color:#666;">ä¾†è‡ªåæ–¹ä¿¡çœ¾çš„æ„Ÿæ‡‰èˆ‡æ„Ÿè¬</p>
    </div>
    
    <div class="marquee-wrapper">
        <div class="marquee-track" id="feedback-track">
            <div style="padding:20px;">è¼‰å…¥ä¸­...</div>
        </div>
    </div>
    
    <div class="fb-link">
        <a href="{{ url_for('feedback_page') }}" style="color:#C48945; font-weight:bold; text-decoration:underline;">æŸ¥çœ‹æ›´å¤šè¦‹è­‰ &raquo;</a>
    </div>
</section>

<section id="remote" class="remote-section">
    <div class="section-header" style="text-align:center; border:none; padding:0;">
        <h2>ç„¡æ³•è¦ªè‡¨ç¾å ´ï¼Ÿ</h2>
        <span>æˆ‘å€‘æä¾›è²¼å¿ƒçš„é è·æœå‹™ï¼Œè®“åº‡ä½‘ç„¡é å¼—å±†ã€‚</span>
    </div>

    <div class="remote-grid">
        <div class="remote-card">
            <img src="{{ url_for('static', filename='images/pages/shoujing/shipping.jpg') }}" alt="è¡£ç‰©å¯„å›" class="remote-img">
            <div class="remote-text">
                <h3>ğŸ“¦ é è·æ”¶é©š (å¯„å›è¡£ç‰©)</h3>
                <p>è‹¥æ‚¨æˆ–å®¶äººä¸ä¾¿å‰ä¾†ï¼Œå¯å°‡è¡£ç‰©å¯„è‡³å¸¥åºœã€‚å…ƒå¸¥åŠ æŒå¾Œï¼Œæˆ‘å€‘å°‡å”åŠ©å¯„å›ï¼Œè®“æ‚¨åœ¨å®¶ä¹Ÿèƒ½ç²å¾—å®‰å®šçš„åŠ›é‡ã€‚</p>
                <a href="{{ url_for('ship_clothes_page') }}" class="btn-action">å¡«å¯«è¡£ç‰©å¯„å›å–®</a>
            </div>
        </div>

        <div class="remote-card">
            <img src="{{ url_for('static', filename='images/pages/incense/product1.png') }}" alt="ç·šä¸Šæé¦™" class="remote-img">
            <div class="remote-text">
                <h3>ğŸ•¯ï¸ ä»£è¾¦æé¦™ â€§ è­·æŒå…¬å£‡</h3>
                <p>æ‚¨çš„æ¯ä¸€ä»½è­·æŒï¼Œéƒ½å°‡åŒ–ä½œå…¬å£‡è¾¦äº‹æ™‚çš„è£Šè£Šé¦™ç…™ã€‚æˆ‘å€‘å°‡æ–¼è¾¦äº‹æ™‚å‘å…ƒå¸¥ç¨Ÿå ±æ‚¨çš„å¿ƒæ„èˆ‡ç¥ˆé¡˜ã€‚</p>
                <a href="{{ url_for('donation_page') }}" class="btn-action">æˆ‘è¦ç·šä¸Šè­·æŒ</a>
            </div>
        </div>
    </div>
</section>

<script>
    // è·‘é¦¬ç‡ˆé‚è¼¯
    document.addEventListener('DOMContentLoaded', () => {
        fetch('/api/feedback/approved')
            .then(res => res.json())
            .then(data => {
                const track = document.getElementById('feedback-track');
                if(!data.length) {
                    track.innerHTML = '<div style="padding:20px; width:100vw; text-align:center;">æš«ç„¡å›é¥‹è³‡æ–™</div>';
                    return;
                }

                // ç”¢ç”Ÿå¡ç‰‡ HTML
                const generateCards = (items) => {
                    return items.map(item => `
                        <div class="feedback-card">
                            <div class="fb-header">
                                <div class="fb-avatar">${item.nickname ? item.nickname[0] : 'å–„'}</div>
                                <div>
                                    <div style="font-weight:bold;">${item.nickname}</div>
                                    <div style="font-size:0.8rem; color:#999;">${item.category}</div>
                                </div>
                            </div>
                            <div class="fb-content">${item.content}</div>
                        </div>
                    `).join('');
                };

                // ç‚ºäº†è®“è·‘é¦¬ç‡ˆä¸é–“æ–·ï¼Œæˆ‘å€‘éœ€è¦è¤‡è£½è¶³å¤ çš„å¡ç‰‡ä¾†å¡«æ»¿è»Œé“
                // è‡³å°‘è¤‡è£½ 2 ä»½ï¼Œå¦‚æœè³‡æ–™å¤ªå°‘å°±è¤‡è£½æ›´å¤šä»½
                let content = generateCards(data);
                if (data.length < 5) { content += content + content; } // è³‡æ–™å°‘å¤šè¤‡è£½å¹¾æ¬¡
                
                // æœ€çµ‚çµæ§‹ï¼šåŸå§‹ + è¤‡è£½ (ç‚ºäº†ç„¡ç¸«æ¥è»Œ)
                track.innerHTML = content + content; 
            });
    });
</script>

{% endblock %}